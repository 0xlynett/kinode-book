# Kernel API

The kernel takes only a few types of requests, and generally the capability to message the kernel will not be available to userspace applications.

```rust
pub enum KernelCommand {
    Booted,
    StartProcess {
        id: ProcessId,
        wasm_bytes_handle: u128,
        on_panic: OnPanic,
        initial_capabilities: HashSet<SignedCapability>,
        public: bool,
    },
    KillProcess(ProcessId),
    RebootProcess {
        process_id: ProcessId,
        persisted: PersistedProcess,
    },
    Shutdown,
}
```

All `KernelCommand`s are sent in the IPC field as this struct serialized to JSON text bytes using `serde_json`.

## `Booted`

Purely for internal use within the kernel.

## `StartProcess`

The command used to start a new process. Generally available to apps via the `spawn()` function in the WIT interface. The `wasm_bytes_handle` is a pointer generated by the [filesystem](filesystem.md) API -- it should be a valid .wasm file compiled using the Uqbar tooling. The `on_panic` field is an enum that specifies what to do if the process panics. The `initial_capabilities` field is a set of capabilities that the process will have access to -- note that the capabilities are signed by this kernel. The `public` field specifies whether the process should be visible to other processes *without* needing to grant a messaging capability.

`StartProcess` must be sent with a payload. The payload must be the same .wasm file, in raw bytes, that the `wasm_bytes_handle` points to.

## `KillProcess`

Takes a process ID and kills it. This is a dangerous operation as messages queued for the process will be lost.

## `RebootProcess`

Purely for internal use within the kernel.

## `Shutdown`

Send to the kernel in order to gracefully shut down the system. The runtime must perform this request before exiting in order to see that all processes are properly cleaned up.